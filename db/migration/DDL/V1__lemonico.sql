-- MySQL Script generated by MySQL Workbench
-- Mon Nov 29 23:36:42 2021
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS = @@UNIQUE_CHECKS, UNIQUE_CHECKS = 0;
SET @OLD_FOREIGN_KEY_CHECKS = @@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS = 0;
SET @OLD_SQL_MODE = @@SQL_MODE, SQL_MODE = '';

-- -----------------------------------------------------
-- Schema lemonico
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `lemonico`;

-- -----------------------------------------------------
-- Schema lemonico
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `lemonico` DEFAULT CHARACTER SET utf8;
USE `lemonico`;

-- -----------------------------------------------------
-- Table `lemonico`.`client`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lemonico`.`client`;

CREATE TABLE IF NOT EXISTS `lemonico`.`client`
(
    `id`          INT          NOT NULL AUTO_INCREMENT COMMENT 'クライアントの自動採番ID',
    `client_code` VARCHAR(10)  NULL COMMENT 'ユーザーコード',
    `first_name`  VARCHAR(255) NOT NULL COMMENT '姓',
    `last_name`   VARCHAR(255) NULL COMMENT '名',
    `email`       VARCHAR(255) NOT NULL COMMENT 'メールアドレス（ログインID）',
    `password`    VARCHAR(255) NOT NULL COMMENT 'パスワード',
    `status`      INT          NOT NULL DEFAULT 1 COMMENT 'ステータス（1:通常 2:ブラックユーザー 3:退会）',
    `created_by`  VARCHAR(255) NOT NULL COMMENT '作成者',
    `created_at`  DATETIME     NOT NULL COMMENT '作成日時',
    `modified_by` VARCHAR(255) NOT NULL COMMENT '更新者',
    `modified_at` DATETIME     NOT NULL COMMENT '更新日時',
    `is_deleted`  INT      NOT NULL DEFAULT 0 COMMENT '削除フラグ（退会から一定時間経過後に削除状態になる）',
    PRIMARY KEY (`id`),
    UNIQUE INDEX `user_code_UNIQUE` (`client_code` ASC)
)
    ENGINE = InnoDB
    DEFAULT CHARACTER SET = utf8mb4
    COMMENT = 'クライアント';


-- -----------------------------------------------------
-- Table `lemonico`.`collection`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lemonico`.`collection`;

CREATE TABLE IF NOT EXISTS `lemonico`.`collection`
(
    `id`              INT          NOT NULL COMMENT 'クレクションの自動採番ID',
    `client_id`       INT          NOT NULL COMMENT 'クライアントの自動採番',
    `collection_code` VARCHAR(10)  NOT NULL COMMENT 'クレクションコード',
    `created_by`      VARCHAR(255) NOT NULL COMMENT '作成者',
    `created_at`      DATETIME     NOT NULL COMMENT '作成日時',
    `modified_by`     VARCHAR(255) NOT NULL COMMENT '更新者',
    `modified_at`     DATETIME     NOT NULL COMMENT '更新日時',
    `is_deleted`      INT          NOT NULL DEFAULT 0 COMMENT '削除フラグ',
    PRIMARY KEY (`id`),
    INDEX `fk_collection_user1_idx` (`client_id` ASC),
    UNIQUE INDEX `collection_code_UNIQUE` (`collection_code` ASC),
    CONSTRAINT `fk_collection_user1`
        FOREIGN KEY (`client_id`)
            REFERENCES `lemonico`.`client` (`id`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB
    COMMENT = 'クレクション';


-- -----------------------------------------------------
-- Table `lemonico`.`face`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `lemonico`.`face`;

CREATE TABLE IF NOT EXISTS `lemonico`.`face`
(
    `id`                INT          NOT NULL AUTO_INCREMENT COMMENT 'フェスの自動採番ID',
    `collection_id`     INT          NOT NULL COMMENT 'クレクションID',
    `face_id`           VARCHAR(255) NOT NULL COMMENT 'Amazon Rekognition が顔に割り当てる一意の識別子',
    `image_id`          VARCHAR(255) NOT NULL COMMENT 'Amazon Rekognition が入力画像に割り当てる一意の識別子',
    `external_image_id` VARCHAR(255) NOT NULL COMMENT 'イメージの名前',
    `created_by`        VARCHAR(255) NOT NULL COMMENT '作成者',
    `created_at`        DATETIME     NOT NULL COMMENT '作成日時',
    `modified_by`       VARCHAR(255) NOT NULL COMMENT '更新者',
    `modified_at`       DATETIME     NOT NULL COMMENT '更新日時',
    `is_deleted`        INT          NOT NULL COMMENT '削除フラグ',
    PRIMARY KEY (`id`),
    INDEX `fk_face_collection1_idx` (`collection_id` ASC),
    CONSTRAINT `fk_face_collection1`
        FOREIGN KEY (`collection_id`)
            REFERENCES `lemonico`.`collection` (`id`)
            ON DELETE NO ACTION
            ON UPDATE NO ACTION
)
    ENGINE = InnoDB
    COMMENT = '顔';


SET SQL_MODE = @OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS = @OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS = @OLD_UNIQUE_CHECKS;
